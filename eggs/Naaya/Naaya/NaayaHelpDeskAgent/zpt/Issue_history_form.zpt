<tal:block tal:define="hasRoleHelpDeskAdministrator here/isHelpDeskAdministrator;
	hasRoleHelpDeskConsultant here/isHelpDeskConsultant;
	sortby python:request.get('sort', 'date'); how python:request.get('how', 'asc')">

<form action="manageIssueHistory" method="post">
<input type="submit" name="delete" value="Clear history" i18n:attributes="value" />
<br /><br />
<table border="0" cellspacing="1" cellpadding="2" width="100%">
	<tr>
		<td class="cellheader" width="1%"></td>
		<td class="cellheader" width="10%" nowrap="nowrap"
			tal:define="qs python:here.GetSortQueryString('date', sortby, how, '');
						sp python:here.GetSortPicture('date', sortby, how)">
			<a class="sortlink" tal:attributes="href string:${here/absolute_url}/history_user_html?${qs}" title="Sort by this property" i18n:attributes="title" i18n:translate="">Date</a>
			<img tal:attributes="src string:misc_/HelpDeskAgent/${sp}" border="0" alt="" />
		</td>
		<td class="cellheader" width="20%"
			tal:define="qs python:here.GetSortQueryString('action', sortby, how, '');
						sp python:here.GetSortPicture('action', sortby, how)">
			<a class="sortlink" tal:attributes="href string:${here/absolute_url}/history_user_html?${qs}" title="Sort by this property" i18n:attributes="title" i18n:translate="">Action</a>
			<img tal:attributes="src string:misc_/HelpDeskAgent/${sp}" border="0" alt="" />
		</td>
		<td class="cellheader" width="10%" nowrap="nowrap"><strong i18n:translate="">User</strong><img src="misc_/HelpDeskAgent/spacer" border="0" alt="" /></td>
		<td class="cellheader" width="10%"
			tal:define="qs python:here.GetSortQueryString('status', sortby, how, '');
						sp python:here.GetSortPicture('status', sortby, how)">
			<a class="sortlink" tal:attributes="href string:${here/absolute_url}/history_user_html?${qs}" title="Sort by this property" i18n:attributes="title" i18n:translate="">Status</a>
			<img tal:attributes="src string:misc_/HelpDeskAgent/${sp}" border="0" alt="" />
		</td>
		<td class="cellheader" width="10%"><strong i18n:translate="">Priority</strong><img src="misc_/HelpDeskAgent/spacer" border="0" alt="" /></td>
		<td class="cellheader" width="15%"><strong i18n:translate="">Assigned to</strong><img src="misc_/HelpDeskAgent/spacer" border="0" alt="" /></td>
		<td class="cellheader" width="30%"><strong i18n:translate="">Additional comment</strong><img src="misc_/HelpDeskAgent/spacer" border="0" alt="" /></td>
	</tr>
	<tal:block tal:repeat="item python:here.SortObjsListByAttr(here.getListIssueHistory(), sortby, how=='desc')">
	<tr tal:define="cellclass python:test(path('repeat/item/odd'), 'celloddd', 'celleven')">
		<td tal:attributes="class cellclass" align="right" tal:content="string:${item/id}." />
		<td tal:attributes="class cellclass" tal:content="python:here.FormatDate(item.date)" />
		<td tal:attributes="class cellclass" tal:content="item/action" />
		<td tal:attributes="class cellclass" tal:content="item/username" />
		<td tal:attributes="class cellclass" tal:content="item/status" />
		<td tal:attributes="class cellclass" tal:content="item/priority" />
		<td tal:attributes="class cellclass" tal:content="item/consultant" />
		<td tal:attributes="class cellclass" tal:content="structure python:here.EncodeTextareaContent(item.comments)" />
	</tr>
	</tal:block>
</table>
</form>

</tal:block>
