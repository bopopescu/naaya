<dtml-let hasRoleHelpDeskAdministrator="isHelpDeskAdministrator()">

<p>
<table border="0" cellspacing="2" cellpadding="2" width="100%">
    <tr><td class="label" nowrap="true">Ticket Number</td><td><dtml-var id html_quote></td></tr>
    <tr><td class="label">Subject/Title</td><td><b><dtml-var subject html_quote null=-></b></td></tr>
    <tr><td class="label" width="15%" nowrap="true" valign="top">Description</td><td class="celltextarea"><dtml-var "EncodeTextareaContent(description)" null=-></td></tr>
    <dtml-if "user_name!=''">
    <tr>
        <td class="label" nowrap="true">Author</td>
        <td><dtml-if "user_name!=''"><dtml-var user_name html_quote null=->&nbsp;</dtml-if></td>
    </tr>
    </dtml-if>
</table>
</p>

<h4>Add comment to this issue</h4>
<form name="frmadd" action="manageIssueComment" method="post" enctype="multipart/form-data">
<table border="0" cellspacing="2" cellpadding="2" width="100%">
    <tr><td class="label">Date</td><td><dtml-var "CurrentDate()"></td></tr>
    <tr><td class="label">User Name</td><td><input type="text" name="username" size="20" value="<dtml-var "getUserName(getAuthenticatedUser())" html_quote>"></td></tr>
    <tr><td class="label">Content type</td><td><input type="radio" name="content_type" value="1" checked>Plain text <input type="radio" name="content_type" value="0">HTML</td></tr>
    <tr><td class="label" valign="top">Content</td><td><textarea name="content" rows="10" cols="70"></textarea></td></tr>
    <dtml-if "isAuthenticated()">
        <tr><td class="label">Attachment</td><td><input type="file" name="attachment" size="20"></td></tr>
    </dtml-if>
    <tr><td>&nbsp;</td><td><input type="submit" name="add" value="Add"></td></tr>
</table>
</form>
<script>try{document.frmadd.username.focus();}catch(e){}</script>

<h4>Issue comments</h4>
<form name="frmlist" action="manageIssueComment" method="post">
    <dtml-in "getListIssueComment()" sort=date>
    <table border="0" cellspacing="0" cellpadding="2" width="100%">
        <tr>
            <td class="cellheader" width="1%"><dtml-if "hasRoleHelpDeskAdministrator or consultant==getAuthenticatedUser()"><input type="checkbox" name="ids" value="<dtml-var id html_quote>"><dtml-else>&nbsp;</dtml-if></td>
            <td class="cellheader" width="15%" nowrap="true"><b>Date:</b> <dtml-var "FormatDate(date)"></td>
            <td class="cellheader" width="15%" nowrap="true"><b>User:</b> <dtml-var username html_quote null=-></td>
            <td class="cellheader" width="10%"><b>Attachment:</b> 
                <dtml-let res="getAttachmentForComment(id)" attobj="res[0]" attFileName="res[1]">
                    <dtml-if "attobj != None">
                        <a href="<dtml-var "attobj.absolute_url(0)">" target="_blank"><dtml-var attFileName html_quote></a>
                    <dtml-else>
                        -
                    </dtml-if>
                </dtml-let>
            </td>
        </tr>
        <tr><td class="celltextarea" colspan="4"><span class="celltextarea"><dtml-if content_type><dtml-var "EncodeTextareaContent(content)" null=-><dtml-else><dtml-var content></dtml-if></span></td></tr>
    </table>
    <br><br>
    </dtml-in>
    <dtml-if "hasRoleHelpDeskAdministrator or consultant==getAuthenticatedUser()">
    <input type="submit" name="delete" value="Delete">
    </dtml-if>
</form>

</dtml-let>
