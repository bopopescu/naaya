<metal:block define-macro="validate">
<script tal:content="python:'var naaya_site_url=%s' % here.rstk.json_dumps(
                              here.getSite().absolute_url())"></script>
<script>$(function() {

var widget_green_topics = $("label[for='w_green-economy-topics']").parent();
var widget_green_efficiency = $("label[for='w_resource-efficiency-topics']").parent();
var widget_water_topics = $("label[for='w_water-resources-topics']").parent();
var widget_water_resources = $("label[for='w_water-resource-management-topics']").parent();

var widgets_by_theme = {
  green: $('<div '+'>').insertAfter(widget_green_efficiency).append(
    widget_green_topics.prev('div.widgetEditMode'),
    widget_green_topics,
    widget_green_efficiency),
  water:$('<div '+'>').insertAfter(widget_water_resources).append(
    widget_water_topics.prev('div.widgetEditMode'),
    widget_water_topics,
    widget_water_resources)
};
widgets_by_theme['green'].add(widgets_by_theme['water']).css({
    'background-color': '#ecf5fa',
    'border': '1px solid #b6cde1'
}).children(':not(:first-child)').css({
    'padding-left': '3em',
});

function show_hide_widgets() {
    var theme_radio_id = $("input[name='w_theme:int']:checked").attr('id');
    if(theme_radio_id == 'w_theme_0') {
        widgets_by_theme['water'].hide();
        widgets_by_theme['green'].show();
    }
    else if(theme_radio_id == 'w_theme_1') {
        widgets_by_theme['water'].show();
        widgets_by_theme['green'].hide();
    }
    else if(theme_radio_id == 'w_theme_2') {
        widgets_by_theme['water'].show();
        widgets_by_theme['green'].show();
    }
    else {
        widgets_by_theme['water'].hide();
        widgets_by_theme['green'].hide();
    }
}

show_hide_widgets();
$("input[name='w_theme:int']").click(show_hide_widgets);

function map_pin_to_label(pin_id, label) {
    var url = naaya_site_url + '/portal_map/getSymbolPicture?id=' + pin_id;
    label.append(' ', $('<img'+'/>').attr('src', url));
}

map_pin_to_label('symbol825', $("label[for='w_theme_0']"));
map_pin_to_label('symbol814', $("label[for='w_theme_1']"));
map_pin_to_label('symbol851', $("label[for='w_theme_2']"));

});</script>
</metal:block>