<dtml-var standard_html_header>

<dtml-let hasRoleHelpDeskAdministrator="isHelpDeskAdministrator()"
       hasRoleHelpConsultant="isHelpDeskConsultant()"
       sortby="REQUEST.get('sort', 'date_modify')"
      how="REQUEST.get('how', 'desc')">

<dtml-var style_html>

<p>

<dtml-var "menu_html(None, _, pagetab=0)">

<dtml-comment>
    load form data
</dtml-comment>
<dtml-call "REQUEST.set('filter_query', REQUEST.get('filter_query', ''))">
<dtml-call "REQUEST.set('filter_category', REQUEST.get('filter_category', ''))">
<dtml-call "REQUEST.set('filter_priority', REQUEST.get('filter_priority', ''))">
<dtml-call "REQUEST.set('filter_status', REQUEST.get('filter_status', ''))">
<dtml-call "REQUEST.set('filter_user_name', REQUEST.get('filter_user_name', ''))">
<dtml-call "REQUEST.set('filter_consultant', REQUEST.get('filter_consultant', ''))">
<dtml-call "REQUEST.set('filter_new', REQUEST.get('filter_new', ''))">
<dtml-call "REQUEST.set('filter_querystring', GetFilterString(filter_query=filter_query, filter_category=filter_category, filter_priority=filter_priority, filter_status=filter_status, filter_user_name=filter_user_name, filter_consultant=filter_consultant, filter_new=filter_new))">

<p>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
    <tr>
        <td class="note">This page lists the issues posted using this agent. Order the list by a field 
        by clicking on the name of that field; clicking twice will reverse the order. You can filter the list
        by any subset of parameters bellow:</td>
    </tr>
</table>
</p>

<dtml-let issues="SearchSortIssues(sortby, how, filter_query, category=filter_category, priority=filter_priority, status=filter_status, user_name=filter_user_name, consultant=filter_consultant, new=filter_new)">
<form name="frm">
<table border="0" cellspacing="1" cellpadding="2" width="100%">
    <tr>
        <td class="celleven" colspan="2">
            <dtml-let paging_info="getStartStopTotalValues(issues, REQUEST)"
                      paging_start="paging_info[0]"
                      paging_stop="paging_info[1]"
                      paging_total="paging_info[2]">
                <dtml-var paging_start> - <dtml-var paging_stop> of <dtml-var paging_total> issues.
            </dtml-let>
        </td>
        <td class="celleven" colspan="6" align="right">
            <dtml-in issues size=issues_perpage start=start previous>
                <a href="<dtml-var "absolute_url(0)">/list_html<dtml-var sequence-query>start=<dtml-var previous-sequence-start-number>" class="batchlink">Previous</a>
            </dtml-in>
            <dtml-in issues size=issues_perpage start=start next>
                <a href="<dtml-var "absolute_url(0)">/list_html<dtml-var sequence-query>start=<dtml-var next-sequence-start-number>" class="batchlink">Next</a>
            </dtml-in>
            &nbsp;
        </td>
    </tr>
    <tr>
        <td nowrap="true" class="cellheader" width="50%"><a class="sortlink" href="<dtml-var "absolute_url(0)">/list_html?<dtml-var "GetSortQueryString('subject', sortby, how, filter_querystring)">" title="Sort by this property">Subject/Title</a><img src="misc_/HelpDeskAgent/<dtml-var "GetSortPicture('subject', sortby, how)">" border="0"></td>
        <td nowrap="true" class="cellheader" width="1%"><a class="sortlink" href="<dtml-var "absolute_url(0)">/list_html?<dtml-var "GetSortQueryString('date_open', sortby, how, filter_querystring)">" title="Sort by this property">Date Open</a><img src="misc_/HelpDeskAgent/<dtml-var "GetSortPicture('date_open', sortby, how)">" border="0"></td>
        <td nowrap="true" class="cellheader" width="1%"><a class="sortlink" href="<dtml-var "absolute_url(0)">/list_html?<dtml-var "GetSortQueryString('date_modify', sortby, how, filter_querystring)">" title="Sort by this property">Last Update</a><img src="misc_/HelpDeskAgent/<dtml-var "GetSortPicture('date_modify', sortby, how)">" border="0"></td>
        <td nowrap="true" class="cellheader" width="20%"><a class="sortlink" href="<dtml-var "absolute_url(0)">/list_html?<dtml-var "GetSortQueryString('consultant', sortby, how, filter_querystring)">" title="Sort by this property">Assign to</a><img src="misc_/HelpDeskAgent/<dtml-var "GetSortPicture('consultant', sortby, how)">" border="0"></td>
        <td nowrap="true" class="cellheader" width="30%"><a class="sortlink" href="<dtml-var "absolute_url(0)">/list_html?<dtml-var "GetSortQueryString('category', sortby, how, filter_querystring)">" title="Sort by this property">Category</a><img src="misc_/HelpDeskAgent/<dtml-var "GetSortPicture('category', sortby, how)">" border="0"></td>
        <td nowrap="true" class="cellheader" width="1%"><a class="sortlink" href="<dtml-var "absolute_url(0)">/list_html?<dtml-var "GetSortQueryString('priority', sortby, how, filter_querystring)">" title="Sort by this property">Priority</a><img src="misc_/HelpDeskAgent/<dtml-var "GetSortPicture('priority', sortby, how)">" border="0"></td>
        <td nowrap="true" class="cellheader" width="1%"><a class="sortlink" href="<dtml-var "absolute_url(0)">/list_html?<dtml-var "GetSortQueryString('status', sortby, how, filter_querystring)">" title="Sort by this property">Status</a><img src="misc_/HelpDeskAgent/<dtml-var "GetSortPicture('status', sortby, how)">" border="0"></td>
        <td nowrap="true" class="cellheader" width="1%">&nbsp;</td>
    </tr>
    <dtml-in issues size=issues_perpage start=start>
    <dtml-if sequence-odd>
        <dtml-call "REQUEST.set('cellclass', 'cellodd')">
    <dtml-else>
        <dtml-call "REQUEST.set('cellclass', 'celleven')">
    </dtml-if>
    <tr>
        <td class="<dtml-var cellclass>"><a class="itemlink" href="<dtml-var "absolute_url(0)">/index_html"><dtml-var subject html_quote size=50></a></td>
        <td class="<dtml-var cellclass>"><dtml-var "FormatDate(date_open)" html_quote></td>
        <td class="<dtml-var cellclass>"><dtml-var "FormatDate(date_modify)" html_quote></td>
        <td class="<dtml-var cellclass>">
            <dtml-if "AUTHENTICATED_USER.getUserName()==consultant">
                <b><dtml-var "getUserName(consultant)" html_quote null=-></b>
            <dtml-else>
                <dtml-var "getUserName(consultant)" html_quote null=->
            </dtml-if>
        </td>
        <td class="<dtml-var cellclass>"><dtml-var "getIssueCategoryTitle(category)" html_quote null=-></td>
        <td class="<dtml-var cellclass>"><dtml-var "getIssuePriorityTitle(priority)" html_quote null=-></td>
        <td class="<dtml-var cellclass>"><dtml-var "getIssueStatusTitle(status)" html_quote null=-></td>
        <td class="<dtml-var cellclass>"><dtml-if "date_open == date_modify"><img src="misc_/HelpDeskAgent/new" border="0"><dtml-else><img src="misc_/HelpDeskAgent/spacer" border="0"></dtml-if></td>
    </tr>
    </dtml-in>
</table>
</form>
</dtml-let>

<form name="filter" method="get" action="list_html">
<table border="0" cellspacing="2" cellpadding="2" width="100%">
    <tr>
        <td class="label" nowrap="true">Query</td>
        <td><input type="text" name="filter_query" size="50" value="<dtml-var filter_query html_quote>"></td>
        <td colspan="4">&nbsp;</td>
    </tr>
    <tr>
        <td class="label">Category</td>
        <td>
        <select name="filter_category">
            <option value=""></option>
            <dtml-in "getListIssueCategory()" sort=title><option value="<dtml-var id html_quote>" <dtml-if "filter_category==id">selected</dtml-if>><dtml-var title html_quote></option></dtml-in>
        </select>
        </td>
        <td class="label">Priority</td>
        <td>
        <select name="filter_priority">
            <option value=""></option>
            <dtml-in "getListIssuePriority()" sort=value><option value="<dtml-var id html_quote>" <dtml-if "filter_priority==id">selected</dtml-if>><dtml-var title html_quote></option></dtml-in>
        </select>
        </td>
        <td class="label">Status</td>
        <td>
        <select name="filter_status">
            <option value=""></option>
            <dtml-in "getListIssueStatus()" sort=order><option value="<dtml-var id html_quote>" <dtml-if "filter_status==id">selected</dtml-if>><dtml-var title html_quote></option></dtml-in>
        </select>
        </td>
    </tr>
    <tr>
        <td class="label" nowrap="true">Assigned to</td>
        <td>
            <select name="filter_consultant">
                <option value=""></option>
                <dtml-in "getListUserConsultant()"><option value="<dtml-var id html_quote>" <dtml-if "filter_consultant==id">selected</dtml-if>><dtml-var "getUserName(id)" html_quote></option></dtml-in>
            </select>
        </td>
        <td class="label" nowrap="true">Only new</td>
        <td><input type="checkbox" name="filter_new" value="on" <dtml-if "filter_new=='on'">checked</dtml-if>></td>
        <td colspan="2" align="left"><input type="submit" name="filter" value="Filter"></td>
    </tr>
</table>
</form>

</dtml-let>

<dtml-var "info_login_html(None, _)">

</p>

<dtml-var standard_html_footer>
